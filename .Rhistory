femalecol <- function(dataframe){
dataframe$wblack <- as.factor(
ifelse(dataframe$hblack == dataframe$mixed & dataframe$hblack == 1, 0,
ifelse(dataframe$hblack == 1 & dataframe$mixed == 0, 1,
ifelse(dataframe$hblack == 0 & dataframe$mixed == 1, 1, 0)))
)
return(dataframe)
}
divorce <- femalecol(divorce)
colNames <- c("id", "edu", "hblack", "mixed", "years", "div")
divorce <- read.table(file = "divorce.txt", header = F, col.names = colNames)
head(divorce)
library(survival)
library(survminer)
library(ggplot2)
femalecol <- function(dataframe){
dataframe$wblack <- as.factor(
ifelse(dataframe$hblack == dataframe$mixed & dataframe$hblack == 1, 0,
ifelse(dataframe$hblack == 1 & dataframe$mixed == 0, 1,
ifelse(dataframe$hblack == 0 & dataframe$mixed == 1, 1, 0)))
)
return(dataframe)
}
divorce <- femalecol(divorce)
divorce$edu <- as.factor(divorce$edu)
divorce$hblack <- as.factor(divorce$hblack)
divorce$mixed <- as.factor(divorce$mixed)
edu_coxph <- coxph(Surv(years,div)~edu , data=divorce)
mixed_coxph <- coxph(Surv(years,div)~mixed , data=divorce)
hblack <- coxph(Surv(years,div)~hblack , data=divorce)
#p-value > .05 so not a good predictor to add to our model
wblack <- coxph(Surv(years,div)~wblack, data=divorce)
eh_coxph <- coxph(Surv(years,div)~edu+hblack , data=divorce)
eh_coxph
em_coxph <- coxph(Surv(years,div)~edu+mixed , data=divorce)
em_coxph
emb_coxph <- coxph(Surv(years,div)~edu+mixed+hblack , data=divorce)
emb_coxph
#The wblack p-valus is way higher than .05
embw_coxph <- coxph(Surv(years,div)~edu+mixed+hblack+wblack, data=divorce)
embw_coxph
#using cox.zph to test which predictors satisfy ph Assumption In order #make a stratified model
ph_test1 <- cox.zph(emb_coxph)
ph_test1
eh_coxph
em_coxph
emb_coxph
embw_coxph
ph_test_wb <- cox.zph(embw_coxph)
ph_test_wb
ph_test2
ph_test2
ph_test2 <- cox.zph(emb_stratified)
emb_stratified <- coxph(Surv(years,div)~edu+mixed+strata(hblack),data=divorce)
emb_stratified
ph_test2 <- cox.zph(emb_stratified)
ph_test2
ph_test2
emb_stratified
ph_test1
